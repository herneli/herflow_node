{"version":3,"sources":["../src/app.js"],"names":["debug","app","oauth","OAuthServer","model","OAuthModel","requireClientAuthentication","password","set","path","join","__dirname","use","express","json","urlencoded","extended","static","indexRouter","apiRouter","bodyParser","post","token","get","authenticate","req","res","send","next","err","locals","message","error","status","render"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,IAAMA,QAAQ,qBAAY,aAAZ,CAAd;;AAEA,IAAIC,MAAM,wBAAV;;AAEAA,IAAIC,KAAJ,GAAY,IAAIC,4BAAJ,CAAgB;AAC1BC,SAAO,IAAIC,oBAAJ,EADmB,EACD;AACzBC,+BAA6B,EAAEC,UAAU,KAAZ;AAFH,CAAhB,CAAZ;AAIA;AACAN,IAAIO,GAAJ,CAAQ,OAAR,EAAiBC,eAAKC,IAAL,CAAUC,SAAV,EAAqB,OAArB,CAAjB;AACAV,IAAIO,GAAJ,CAAQ,aAAR,EAAuB,KAAvB;;AAEAP,IAAIW,GAAJ,CAAQ,sBAAO,KAAP,CAAR;AACAX,IAAIW,GAAJ,CAAQC,kBAAQC,IAAR,EAAR;AACAb,IAAIW,GAAJ,CAAQC,kBAAQE,UAAR,CAAmB,EAAEC,UAAU,KAAZ,EAAnB,CAAR;AACAf,IAAIW,GAAJ,CAAQ,6BAAR;AACAX,IAAIW,GAAJ,CAAQC,kBAAQI,MAAR,CAAeR,eAAKC,IAAL,CAAUC,SAAV,EAAqB,QAArB,CAAf,CAAR;;AAEAV,IAAIW,GAAJ,CAAQ,GAAR,EAAaM,eAAb;AACAjB,IAAIW,GAAJ,CAAQ,MAAR,EAAgBO,aAAhB;;AAEAlB,IAAIW,GAAJ,CAAQQ,qBAAWN,IAAX,EAAR;AACAb,IAAIW,GAAJ,CAAQQ,qBAAWL,UAAX,CAAsB,EAAEC,UAAU,KAAZ,EAAtB,CAAR;;AAEAf,IAAIoB,IAAJ,CAAS,cAAT,EAAyBpB,IAAIC,KAAJ,CAAUoB,KAAV,EAAzB;;AAEA;AACA;AACA;AACArB,IAAIsB,GAAJ,CAAQ,SAAR,EAAmBtB,IAAIC,KAAJ,CAAUsB,YAAV,EAAnB,EAA6C,UAASC,GAAT,EAAcC,GAAd,EAAmB;AAC9D;AACAA,MAAIC,IAAJ,CAAS,aAAT;AACD,CAHD;;AAKA;AACA1B,IAAIW,GAAJ,CAAQ,UAASa,GAAT,EAAcC,GAAd,EAAmBE,IAAnB,EAAyB;AAC/BA,OAAK,0BAAY,GAAZ,CAAL;AACD,CAFD;;AAIA;AACA3B,IAAIW,GAAJ,CAAQ,UAASiB,GAAT,EAAcJ,GAAd,EAAmBC,GAAnB,EAAwBE,IAAxB,EAA8B;AACpC;AACAF,MAAII,MAAJ,CAAWC,OAAX,GAAqBF,IAAIE,OAAzB;AACAL,MAAII,MAAJ,CAAWE,KAAX,GAAmBP,IAAIxB,GAAJ,CAAQsB,GAAR,CAAY,KAAZ,MAAuB,aAAvB,GAAuCM,GAAvC,GAA6C,EAAhE;;AAEA;AACAH,MAAIO,MAAJ,CAAWJ,IAAII,MAAJ,IAAc,GAAzB;AACAP,MAAIQ,MAAJ,CAAW,OAAX;AACD,CARD;;AAUA;kBACejC,G","file":"app.js","sourcesContent":["import createError from \"http-errors\";\nimport express from \"express\";\nimport path from \"path\";\nimport cookieParser from \"cookie-parser\";\nimport bodyParser from \"body-parser\";\nimport logger from \"morgan\";\nimport OAuthServer from \"express-oauth-server\";\nimport OAuthModel from \"./oauth2/OAuthModel\";\nimport indexRouter from \"./routes/index\";\nimport apiRouter from \"./routes/api\";\nimport debugModule from \"debug\";\n\nconst debug = debugModule(\"test:server\");\n\nvar app = express();\n\napp.oauth = new OAuthServer({\n  model: new OAuthModel(), // See https://github.com/oauthjs/node-oauth2-server for specification\n  requireClientAuthentication: { password: false }\n});\n// view engine setup\napp.set(\"views\", path.join(__dirname, \"views\"));\napp.set(\"view engine\", \"ejs\");\n\napp.use(logger(\"dev\"));\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\napp.use(cookieParser());\napp.use(express.static(path.join(__dirname, \"public\")));\n\napp.use(\"/\", indexRouter);\napp.use(\"/api\", apiRouter);\n\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({ extended: false }));\n\napp.post(\"/oauth/token\", app.oauth.token());\n\n// Enter the secure area\n//app.use(\"/api\", app.oauth.authenticate(), apiRouter);\n// Get secret.\napp.get(\"/secret\", app.oauth.authenticate(), function(req, res) {\n  // Will require a valid access_token.\n  res.send(\"Secret area\");\n});\n\n// catch 404 and forward to error handler\napp.use(function(req, res, next) {\n  next(createError(404));\n});\n\n// error handler\napp.use(function(err, req, res, next) {\n  // set locals, only providing error in development\n  res.locals.message = err.message;\n  res.locals.error = req.app.get(\"env\") === \"development\" ? err : {};\n\n  // render the error page\n  res.status(err.status || 500);\n  res.render(\"error\");\n});\n\n// module.exports = app;\nexport default app;\n"]}